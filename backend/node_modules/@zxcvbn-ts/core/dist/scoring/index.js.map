{"version":3,"file":"index.js","sources":["../../src/scoring/index.ts"],"sourcesContent":[null],"names":["scoringHelper","password","optimal","excludeAdditive","separatorRegex","undefined","fillArray","size","valueType","result","i","value","push","makeBruteforceMatch","j","pattern","token","slice","update","match","sequenceLength","k","estimatedMatch","estimateGuesses","pi","guesses","g","utils","factorial","MIN_GUESSES_BEFORE_GROWING_SEQUENCE","shouldSkip","Object","keys","forEach","competingPatternLength","competingMetricMatch","parseInt","m","bruteforceUpdate","passwordCharIndex","tmp","lastMatch","unwind","passwordLength","optimalMatchSequence","temp","candidateSequenceLength","candidateMetricMatch","unshift","mostGuessableMatchSequence","matches","length","matchesByCoordinateJ","map","sort","m1","m2","optimalSequenceLength","getGuesses","guessesLog10","log10","sequence"],"mappings":"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"}